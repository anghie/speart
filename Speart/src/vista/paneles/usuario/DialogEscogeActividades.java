/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package vista.paneles.usuario;

import controlador.acciones.proceso.ControladorEscogeActividades;
import controlador.basedatos.OperacionesBD;
import javax.swing.JOptionPane;
import modelo.proceso.Actividad;
import vista.modelo.Mensaje;

/**
 *
 * @author francisco
 */
public class DialogEscogeActividades extends javax.swing.JDialog {

    /**
     * Creates new form DialogEscogeActividades
     */
    public DialogEscogeActividades(java.awt.Frame parent, boolean modal) {
        super(parent, modal);
        initComponents();
        ControladorEscogeActividades.lstDisp = lstActivDisponibles;
        ControladorEscogeActividades.lstAsig = lstActividAsignadas;
        ControladorEscogeActividades.llenaListaDisponibles();
        ControladorEscogeActividades.llenaListaAsignadas();
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        scrollAsignadas = new javax.swing.JScrollPane();
        lstActividAsignadas = new javax.swing.JList();
        scrollDisponibles = new javax.swing.JScrollPane();
        lstActivDisponibles = new javax.swing.JList();
        btnQuitar = new javax.swing.JButton();
        btnAgregar = new javax.swing.JButton();
        btnAceptar = new javax.swing.JButton();
        btnCerrar = new javax.swing.JButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        getContentPane().setLayout(null);

        scrollAsignadas.setViewportView(lstActividAsignadas);

        getContentPane().add(scrollAsignadas);
        scrollAsignadas.setBounds(430, 20, 310, 180);

        scrollDisponibles.setViewportView(lstActivDisponibles);

        getContentPane().add(scrollDisponibles);
        scrollDisponibles.setBounds(20, 20, 310, 180);

        btnQuitar.setText("Quitar");
        btnQuitar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnQuitarActionPerformed(evt);
            }
        });
        getContentPane().add(btnQuitar);
        btnQuitar.setBounds(340, 110, 80, 30);

        btnAgregar.setText("Agregar");
        btnAgregar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAgregarActionPerformed(evt);
            }
        });
        getContentPane().add(btnAgregar);
        btnAgregar.setBounds(340, 60, 80, 30);

        btnAceptar.setText("Aceptar");
        btnAceptar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAceptarActionPerformed(evt);
            }
        });
        getContentPane().add(btnAceptar);
        btnAceptar.setBounds(320, 240, 110, 40);

        btnCerrar.setText("Cerrar");
        btnCerrar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCerrarActionPerformed(evt);
            }
        });
        getContentPane().add(btnCerrar);
        btnCerrar.setBounds(652, 242, 90, 40);

        setSize(new java.awt.Dimension(771, 322));
        setLocationRelativeTo(null);
    }// </editor-fold>//GEN-END:initComponents

    private void btnCerrarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCerrarActionPerformed

        dispose();
    }//GEN-LAST:event_btnCerrarActionPerformed

    private void btnAgregarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAgregarActionPerformed
        if (lstActivDisponibles.getSelectedIndex() != -1) {
            Actividad a = ControladorEscogeActividades.actividadesDisponibles.get(lstActivDisponibles.getSelectedIndex());
            ControladorEscogeActividades.agregaItemAsignadas(a);
        } else {
            if (ControladorEscogeActividades.actividadesDisponibles.isEmpty()) {
                JOptionPane.showMessageDialog(null, "Lista de Actividades Disponibles vacia");
            } else {
                Mensaje.filaNoSeleccionada();
            }
        }
    }//GEN-LAST:event_btnAgregarActionPerformed

    private void btnQuitarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnQuitarActionPerformed
        if (lstActividAsignadas.getSelectedIndex() != -1) {
            Actividad a = ControladorEscogeActividades.actividadesAsignadas.get(lstActividAsignadas.getSelectedIndex());
            ControladorEscogeActividades.quitaItemAsignadas(a);
        } else {
            if (ControladorEscogeActividades.actividadesAsignadas.isEmpty()) {
                JOptionPane.showMessageDialog(null, "Lista de Actividades Asignadas vacia");
            } else {
                Mensaje.filaNoSeleccionada();
            }
        }
    }//GEN-LAST:event_btnQuitarActionPerformed

    private void btnAceptarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAceptarActionPerformed
        int i = 0;
        for (Actividad a : ControladorEscogeActividades.actividadesAsignadas) {
            i++;
            a.setParaEvaluacion(true);
            OperacionesBD.modificar(a);
        }
        for (Actividad a : ControladorEscogeActividades.actividadesDisponibles) {
            a.setParaEvaluacion(false);
            OperacionesBD.modificar(a);
        }        
        if (i == ControladorEscogeActividades.actividadesAsignadas.size()) {
//            DialogInformeActiv.llenaPnlDatosInf();
            dispose();
        }
    }//GEN-LAST:event_btnAceptarActionPerformed
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAceptar;
    private javax.swing.JButton btnAgregar;
    private javax.swing.JButton btnCerrar;
    private javax.swing.JButton btnQuitar;
    private javax.swing.JList lstActivDisponibles;
    private javax.swing.JList lstActividAsignadas;
    private javax.swing.JScrollPane scrollAsignadas;
    private javax.swing.JScrollPane scrollDisponibles;
    // End of variables declaration//GEN-END:variables
}
