/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */
package vista.paneles.usuario;

import controlador.acciones.usuario.ControladorConocUsuario;
import java.awt.event.ActionEvent;
import java.awt.event.ActionListener;
import javax.swing.JOptionPane;
import modelo.pregunta.Seccion;
import modelo.proceso.Rol;
import vista.modelo.ImagenJPanel;
import vista.modelo.Mensaje;

/**
 *
 * @author jenny
 */
public class DialogConocUsuario extends javax.swing.JDialog {

    private ControladorConocUsuario ccu;
    private GestorControladorConocUsuario gccu;
    private Rol rol;

    /**
     * Creates new form DialogConocUsuario
     */
    public DialogConocUsuario(java.awt.Frame parent, boolean modal, Rol rol) {
        super(parent, modal);
        initComponents();
        this.rol = rol;
        ccu = new ControladorConocUsuario(this);
        gccu = new GestorControladorConocUsuario();
        ccu.listarSeccion();
        ccu.poneLstConocDisp();
        ccu.poneLstConocAsig();
        poneEventos();
    }

    private void poneEventos() {
        btnAceptar.addActionListener(gccu);
        btnAgregarConocimiento.addActionListener(gccu);
        btnQuitarConocimiento.addActionListener(gccu);
    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel1 = new javax.swing.JPanel();
        scrollDisponibles = new javax.swing.JScrollPane();
        lstConocimientosDisp = new javax.swing.JList();
        scrollAsignadas = new javax.swing.JScrollPane();
        lstConocimientosAsignados = new javax.swing.JList();
        btnAgregarConocimiento = new javax.swing.JButton();
        btnQuitarConocimiento = new javax.swing.JButton();
        btnAceptar = new javax.swing.JButton();
        btnCerrar = new javax.swing.JButton();
        jLabel2 = new javax.swing.JLabel();
        jLabel1 = new javax.swing.JLabel();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
        getContentPane().setLayout(null);

        jPanel1  = new  ImagenJPanel ("images.jpg");
        jPanel1.setLayout(null);

        scrollDisponibles.setViewportView(lstConocimientosDisp);

        jPanel1.add(scrollDisponibles);
        scrollDisponibles.setBounds(20, 40, 310, 180);

        scrollAsignadas.setViewportView(lstConocimientosAsignados);

        jPanel1.add(scrollAsignadas);
        scrollAsignadas.setBounds(450, 40, 310, 180);

        btnAgregarConocimiento.setIcon(new javax.swing.ImageIcon(getClass().getResource("/vista/imagenes/list-add.png"))); // NOI18N
        btnAgregarConocimiento.setText("Agregar");
        btnAgregarConocimiento.setToolTipText("Agregar Conocimientos");
        jPanel1.add(btnAgregarConocimiento);
        btnAgregarConocimiento.setBounds(330, 60, 100, 30);

        btnQuitarConocimiento.setIcon(new javax.swing.ImageIcon(getClass().getResource("/vista/imagenes/salir_1.png"))); // NOI18N
        btnQuitarConocimiento.setText("Quitar");
        btnQuitarConocimiento.setToolTipText("Quitar Conocimientos de conocimientos agregados ");
        jPanel1.add(btnQuitarConocimiento);
        btnQuitarConocimiento.setBounds(330, 110, 100, 30);

        btnAceptar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/vista/imagenes/acepta.png"))); // NOI18N
        btnAceptar.setText("Aceptar");
        btnAceptar.setToolTipText("Guardar Conocimientos");
        jPanel1.add(btnAceptar);
        btnAceptar.setBounds(520, 240, 110, 40);

        btnCerrar.setIcon(new javax.swing.ImageIcon(getClass().getResource("/vista/imagenes/exit.png"))); // NOI18N
        btnCerrar.setText("Cerrar");
        btnCerrar.setToolTipText("Salir sin Guardar Conocmientos");
        btnCerrar.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnCerrarActionPerformed(evt);
            }
        });
        jPanel1.add(btnCerrar);
        btnCerrar.setBounds(630, 240, 110, 40);

        jLabel2.setFont(new java.awt.Font("Verdana", 1, 12)); // NOI18N
        jLabel2.setText("Conocimientos a agregar:");
        jPanel1.add(jLabel2);
        jLabel2.setBounds(20, 20, 180, 16);

        jLabel1.setFont(new java.awt.Font("Verdana", 1, 12)); // NOI18N
        jLabel1.setText("Conocimientos agregados");
        jPanel1.add(jLabel1);
        jLabel1.setBounds(460, 20, 180, 16);

        getContentPane().add(jPanel1);
        jPanel1.setBounds(0, 0, 760, 300);

        java.awt.Dimension screenSize = java.awt.Toolkit.getDefaultToolkit().getScreenSize();
        setBounds((screenSize.width-777)/2, (screenSize.height-338)/2, 777, 338);
    }// </editor-fold>//GEN-END:initComponents

    private void btnCerrarActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnCerrarActionPerformed

        dispose();
    }//GEN-LAST:event_btnCerrarActionPerformed
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JButton btnAceptar;
    private javax.swing.JButton btnAgregarConocimiento;
    private javax.swing.JButton btnCerrar;
    private javax.swing.JButton btnQuitarConocimiento;
    private javax.swing.JLabel jLabel1;
    private javax.swing.JLabel jLabel2;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JList lstConocimientosAsignados;
    private javax.swing.JList lstConocimientosDisp;
    private javax.swing.JScrollPane scrollAsignadas;
    private javax.swing.JScrollPane scrollDisponibles;
    // End of variables declaration//GEN-END:variables

    /**
     * @return the lstConocimientosAsignados
     */
    public javax.swing.JList getLstConocimientosAsignados() {
        return lstConocimientosAsignados;
    }

    /**
     * @return the lstConocimientosDisp
     */
    public javax.swing.JList getLstConocimientosDisp() {
        return lstConocimientosDisp;
    }

    /**
     * @return the rol
     */
    public Rol getRol() {
        return rol;
    }

    class GestorControladorConocUsuario implements ActionListener {

        @Override
        public void actionPerformed(ActionEvent e) {
            if (e.getSource() == btnAgregarConocimiento) {
                if (lstConocimientosDisp.getSelectedIndex() != -1) {
                    Seccion s = ccu.getConocimientosDisponibles().get(lstConocimientosDisp.getSelectedIndex());
                    ccu.agregaItemConocAsignados(s);
                } else {
                    if (ccu.getConocimientosDisponibles().isEmpty()) {
                        JOptionPane.showMessageDialog(null, "Lista de Conocimientos Disponibles vacia");
                    } else {
                        Mensaje.filaNoSeleccionada();
                    }
                }
            } else if (e.getSource() == btnQuitarConocimiento) {
                if (lstConocimientosAsignados.getSelectedIndex() != -1) {
                    Seccion s = ccu.getConocimientosAsignados().get(lstConocimientosAsignados.getSelectedIndex());
                    ccu.quitaItemConocAsignados(s);
                } else {
                    if (ccu.getConocimientosAsignados().isEmpty()) {
                        JOptionPane.showMessageDialog(null, "Lista de Conocimientos Asignados vacia");
                    } else {
                        Mensaje.filaNoSeleccionada();
                    }
                }
            } else if (e.getSource() == btnAceptar) {
                int opc = JOptionPane.showConfirmDialog(null, "Â¿Desea Guardar los datos?", "Guardar", JOptionPane.YES_NO_OPTION);
                if (opc == JOptionPane.YES_OPTION) {
                    ccu.guardaConocUsuario();
                }
                dispose();
            }
        }
    }
}
